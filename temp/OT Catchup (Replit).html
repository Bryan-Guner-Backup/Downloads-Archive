<!DOCTYPE html><html><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>OT Catchup (Replit)</title>
	<style data-savepage-href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/dark.min.css">@charset "UTF-8";body{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;line-height:1.4;max-width:800px;margin:20px auto;padding:0 10px;color:#dbdbdb;background:#202b38;text-rendering:optimizeLegibility}button,input,textarea{transition:background-color .1s linear,border-color .1s linear,color .1s linear,box-shadow .1s linear,transform .1s ease}h1{font-size:2.2em;margin-top:0}h1,h2,h3,h4,h5,h6{margin-bottom:12px}h1,h2,h3,h4,h5,h6,strong{color:#fff}b,h1,h2,h3,h4,h5,h6,strong,th{font-weight:600}blockquote{border-left:4px solid rgba(0,150,191,.67);margin:1.5em 0;padding:.5em 1em;font-style:italic}blockquote>footer{margin-top:10px;font-style:normal}address,blockquote cite{font-style:normal}a[href^=mailto]:before{content:"📧 "}a[href^=tel]:before{content:"📞 "}a[href^=sms]:before{content:"💬 "}button,input[type=button],input[type=checkbox],input[type=submit]{cursor:pointer}input:not([type=checkbox]):not([type=radio]),select{display:block}button,input,select,textarea{color:#fff;background-color:#161f27;font-family:inherit;font-size:inherit;margin-right:6px;margin-bottom:6px;padding:10px;border:none;border-radius:6px;outline:none}button,input:not([type=checkbox]):not([type=radio]),select,textarea{-webkit-appearance:none}textarea{margin-right:0;width:100%;box-sizing:border-box;resize:vertical}button,input[type=button],input[type=submit]{padding-right:30px;padding-left:30px}button:hover,input[type=button]:hover,input[type=submit]:hover{background:#324759}button:focus,input:focus,select:focus,textarea:focus{box-shadow:0 0 0 2px rgba(0,150,191,.67)}button:active,input[type=button]:active,input[type=checkbox]:active,input[type=radio]:active,input[type=submit]:active{transform:translateY(2px)}button:disabled,input:disabled,select:disabled,textarea:disabled{cursor:not-allowed;opacity:.5}::-webkit-input-placeholder{color:#a9a9a9}:-ms-input-placeholder{color:#a9a9a9}::-ms-input-placeholder{color:#a9a9a9}::placeholder{color:#a9a9a9}a{text-decoration:none;color:#41adff}a:hover{text-decoration:underline}code,kbd{background:#161f27;color:#ffbe85;padding:5px;border-radius:6px}pre>code{padding:10px;display:block;overflow-x:auto}img{max-width:100%}hr{border:none;border-top:1px solid #dbdbdb}table{border-collapse:collapse;margin-bottom:10px;width:100%}td,th{padding:6px;text-align:left}th{border-bottom:1px solid #dbdbdb}tbody tr:nth-child(2n){background-color:#161f27}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-track{background:#161f27;border-radius:6px}::-webkit-scrollbar-thumb{background:#324759;border-radius:6px}::-webkit-scrollbar-thumb:hover{background:#415c73}
/*# sourceMappingURL=dark.min.css.map */
</style>
	<style data-savepage-href="style.css" type="text/css">li {
  padding: 8px 0;
}</style>
  <style data-savepage-href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism-tomorrow.min.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style>

<style id="savepage-cssvariables">
  :root {
  }
</style>
<script id="savepage-shadowloader" type="application/javascript">
  "use strict";
  window.addEventListener("DOMContentLoaded",
  function(event) {
    savepage_ShadowLoader(5);
  },false);
  function savepage_ShadowLoader(c){createShadowDOMs(0,document.documentElement);function createShadowDOMs(a,b){var i;if(b.localName=="iframe"||b.localName=="frame"){if(a<c){try{if(b.contentDocument.documentElement!=null){createShadowDOMs(a+1,b.contentDocument.documentElement)}}catch(e){}}}else{if(b.children.length>=1&&b.children[0].localName=="template"&&b.children[0].hasAttribute("data-savepage-shadowroot")){b.attachShadow({mode:"open"}).appendChild(b.children[0].content);b.removeChild(b.children[0]);for(i=0;i<b.shadowRoot.children.length;i++)if(b.shadowRoot.children[i]!=null)createShadowDOMs(a,b.shadowRoot.children[i])}for(i=0;i<b.children.length;i++)if(b.children[i]!=null)createShadowDOMs(a,b.children[i])}}}
</script>
<meta name="savepage-url" content="https://otcatchup.util.repl.co/">
<meta name="savepage-title" content="OT Catchup (Replit)">
<meta name="savepage-pubdate" content="Unknown">
<meta name="savepage-from" content="https://otcatchup.util.repl.co/">
<meta name="savepage-date" content="Thu Sep 23 2021 16:50:05 GMT-0400 (Eastern Daylight Time)">
<meta name="savepage-state" content="Custom Items; Retain cross-origin frames; Merge CSS images; Remove unsaved URLs; Load lazy images in existing content; Max frame depth = 5; Max resource size = 50MB; Max resource time = 10s;">
<meta name="savepage-version" content="26.2">
<meta name="savepage-comments" content="">
  </head>


<body class="language-js">
  <script data-savepage-src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/prism.min.js"></script>
	<h2 id="catching-up">Catching up</h2>
	<p>When people code together on Replit, everyone's code needs to be in sync. You have to see the same code as I do even though we're typing on different computers. The challenge is making sure we don't end up with a jumbled mess of text while we type together.</p>

	<p>So in order to keep everyone's code in sync, Replit uses a method called <strong>Operational Transformations, or OT</strong>.</p>

	<p>Think about OT like this: when you type, you can either <i>insert</i> text, <i>delete</i> text, or <i>move</i> your cursor to a new position (this is called <i>skip</i> in OT land). These actions are called <strong>operations</strong>, and they <strong>transform</strong> your document! 

	</p><p>More concretely, you can look at an Operational Transformation as a function that takes in a document, a position within that document (like where your cursor is), and then either modifies the document at that position or skips to a new position.</p>


	<strong>Some examples:</strong>
	<p></p>
	<ol>
		<!-- Example 1 -->
		<li class="example">
			<ul>
				<li>Input document: <code class=" language-js"><span class="token string">""</span></code></li>
				<li>Starting cursor position: <code class=" language-js"><span class="token number">0</span></code></li>
				<li>Operation: <code class=" language-js"><span class="token punctuation">{</span><span class="token string">"op"</span><span class="token operator">:</span> <span class="token string">"insert"</span><span class="token punctuation">,</span> <span class="token string">"chars"</span><span class="token operator">:</span> <span class="token string">"Hello, human!"</span><span class="token punctuation">}</span></code></li>
				<li>Output document: <code class=" language-js"><span class="token string">"Hello, human!"</span></code></li>
				<li>Ending cursor position: <code class=" language-js"><span class="token number">13</span></code></li>
			</ul>
		</li>
		<!-- Example 2 -->
		<li class="example">
			<ul>
				<li>Input document: <code class=" language-js"><span class="token string">"What is up?"</span></code></li>
				<li>Starting cursor position: <code class=" language-js"><span class="token number">7</span></code></li>
				<li>Operation: <code class=" language-js"><span class="token punctuation">{</span><span class="token string">"op"</span><span class="token operator">:</span> <span class="token string">"delete"</span><span class="token punctuation">,</span> <span class="token string">"count"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span></code></li>
				<li>Output document: <code class=" language-js"><span class="token string">"What is?"</span></code></li>
				<li>Ending cursor position: <code class=" language-js"><span class="token number">7</span></code></li>
			</ul>
		</li>
		
	<i class="note">Watch out: <code class=" language-js"><span class="token keyword">delete</span></code> operations are applied moving forward. Crazy, we know.</i>

	<!-- Example 3 -->
	<li class="example">
			<ul>
				<li>Input document: <code class=" language-js"><span class="token string">"Nice!"</span></code></li>
				<li>Starting cursor position: <code class=" language-js"><span class="token number">0</span></code></li>
				<li>Operation (1): <code class=" language-js"><span class="token punctuation">{</span><span class="token string">"op"</span><span class="token operator">:</span> <span class="token string">"skip"</span><span class="token punctuation">,</span> <span class="token string">"count"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">}</span></code></li>
				<li>Operation (2): <code class=" language-js"><span class="token punctuation">{</span><span class="token string">"op"</span><span class="token operator">:</span> <span class="token string">"insert"</span><span class="token punctuation">,</span> <span class="token string">"chars"</span><span class="token operator">:</span> <span class="token string">" day"</span><span class="token punctuation">}</span></code></li>
				<li>Output document: <code class=" language-js"><span class="token string">"Nice day!"</span></code></li>
				<li>Ending cursor position: <code class=" language-js"><span class="token number">8</span></code></li>
			</ul>
	</li>
	
	<i class="note">As you can see, this last example applies two transformations in a row.</i>
</ol>

<h2>What we want you to do</h2>
<p>Back to keeping everyone in a multiplayer repl in sync. In the real world, we don't always work at the same time. Sometimes people leave then rejoin later, or lose their internet connection and come back online. When people rejoin, we need their client to <strong>"catch up"</strong> to the current state of the repl so everyone has the same code in front of them!

</p><p>So when we catch up, we need to validate that a sequence of operational transformations will actually produce the most recent version of your code. It would be pretty terrible if I edited your file while you're gone, then you somehow end up with the wrong file contents when you rejoin later 😢</p>
	
<p><strong>For this challenge, you're going to write the OT validation function.</strong> The function will take in a string for the stale file contents, a string containing the latest file contents, and a JSON string containing the operations.</p>

<h4>Gotchas:</h4>
<ul>
	<li>You can't skip past the end of a string</li>
	<li>You can't delete past the end of a string</li>
	<li>Delete operations move the cursor position forward</li>
</ul>

<p>You may use any language! Please choose a language you are comfortable coding in quickly. Here are some examples in JavaScript:</p>

<pre class=" language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token parameter">stale<span class="token punctuation">,</span> latest<span class="token punctuation">,</span> otjson</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this is the part you will write!</span>
<span class="token punctuation">}</span>

<span class="token function">isValid</span><span class="token punctuation">(</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'Repl.it uses operational transformations.'</span><span class="token punctuation">,</span>
  <span class="token string">'[{"op": "skip", "count": 40}, {"op": "delete", "count": 47}]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token function">isValid</span><span class="token punctuation">(</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'Repl.it uses operational transformations.'</span><span class="token punctuation">,</span>
  <span class="token string">'[{"op": "skip", "count": 45}, {"op": "delete", "count": 47}]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false, delete past end</span>

<span class="token function">isValid</span><span class="token punctuation">(</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'Repl.it uses operational transformations.'</span><span class="token punctuation">,</span>
  <span class="token string">'[{"op": "skip", "count": 40}, {"op": "delete", "count": 47}, {"op": "skip", "count": 2}]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false, skip past end</span>

<span class="token function">isValid</span><span class="token punctuation">(</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'We use operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'[{"op": "delete", "count": 7}, {"op": "insert", "chars": "We"}, {"op": "skip", "count": 4}, {"op": "delete", "count": 1}]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token function">isValid</span><span class="token punctuation">(</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'Repl.it uses operational transformations to keep everyone in a multiplayer repl in sync.'</span><span class="token punctuation">,</span>
  <span class="token string">'[]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>
<p>Please <a href="https://replit.com/signup">sign up</a> for a Replit account if you have not already. Create a new repl for this problem and do all your coding in that repl. We ask that you spend no more than 30 minutes on this. When you're ready to share your repl with us, please click the Invite button, find the link that starts with <code class=" language-js">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>repl<span class="token punctuation">.</span>it<span class="token operator">/</span>join<span class="token operator">/</span></code>, copy it, and send it to us!</p>

<p>We value straightforward, working code over clever, not-quite-working code, so try to get something working right away, even if it doesn’t cover all the possible cases. Good luck! We can’t wait to hear from you.</p>



<span style="margin: 0px auto; border: 2px dotted rgb(0, 0, 0); position: absolute; z-index: 2147483647; visibility: hidden; left: 1751px; width: 0px; top: 474px; height: 0px;"></span><span style="z-index: 2147483647; position: absolute; visibility: hidden; left: 1736px; width: 50px; top: 459px; height: 20px; font-size: 10px; color: black;"></span></body></html>